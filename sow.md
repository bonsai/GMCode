Chrome拡張機能エディター詳細仕様書1. 概要1.1 プロジェクト名ReactとGemini APIを使用したマルチモーダルChrome拡張機能エディター1.2 目的本ドキュメントは、Google Gemini APIのマルチモーダル機能を活用し、テキストと画像を同時に扱えるVS Code風のUIを持つChrome拡張機能エディターの開発に関する詳細な仕様を定義する。これにより、ユーザーはWebブラウザ上でシームレスにAIアシスタントの恩恵を受け、効率的なコンテンツ生成や情報分析を行うことを目的とする。1.3 対象読者開発チーム、プロジェクトマネージャー、品質保証担当者、および関連するステークホルダー。2. 機能要件2.1 UI/UX (VS Code風インターフェース)全体レイアウト:サイドバー（左側）：設定、履歴などのナビゲーションエリア。エディターエリア（中央）：主要なテキスト入力および画像表示エリア。出力パネル（下部）：Gemini APIからの応答を表示するエリア。ステータスバー（下部）：APIステータス、エラーメッセージなどを表示。テーマ: ダークテーマをデフォルトとし、VS Codeに似た配色を採用する。アイコン: Lucide Reactなどのアイコンライブラリを使用し、VS Codeのアイコンセットに準じたデザインを採用する。レスポンシブデザイン: Chrome拡張機能のポップアップサイズに合わせて、UIが適切に調整されること。2.2 エディター機能テキスト入力:複数行のテキスト入力に対応したエリアを提供。基本的なテキスト編集（コピー、ペースト、カット）が可能。入力文字数カウンター（任意）。画像アップロード:画像ファイル（JPEG, PNG, GIF, WebPなど）のアップロードボタンを提供。ドラッグ＆ドロップによる画像アップロードに対応。アップロードされた画像のプレビュー表示（サムネイルまたは原寸大）。複数画像のアップロードに対応し、それぞれを識別可能にする。送信ボタン: 入力されたテキストと画像をGemini APIに送信するボタン。2.3 Gemini API連携APIエンドポイント: gemini-2.0-flashモデルを使用し、generateContentメソッドを呼び出す。リクエスト形式:ユーザー入力テキストをparts配列のtextとして含める。アップロードされた画像をBase64エンコードし、parts配列のinlineDataとしてmimeTypeと共に含める。generationConfigはデフォルト設定を使用する。応答処理:APIからの応答テキストを解析し、出力パネルに表示する。エラーが発生した場合（APIキーが無効、ネットワークエラーなど）は、適切なエラーメッセージをステータスバーに表示する。API呼び出し中はローディングインジケーターを表示する。2.4 APIキー設定設定画面: サイドバーまたは専用のタブからアクセス可能なAPIキー設定画面を提供。入力フィールド: Gemini APIキーを入力するためのテキストフィールド。保存機能: 入力されたAPIキーをChromeのchrome.storage.localに安全に保存する。キーの検証: APIキーの形式が正しいかどうかの簡易的な検証（任意）。2.5 出力パネル応答表示: Gemini APIからの生成テキストを整形して表示。シンタックスハイライト: コードブロック（例: Markdownのjsなど）を自動的に検出し、シンタックスハイライトを適用する（highlight.jsまたはPrism.jsなどのライブラリを使用）。クリア機能: 出力パネルの内容をクリアするボタン。2.6 エラーハンドリングネットワークエラー: API通信失敗時のユーザーへの通知。APIエラー: APIからのエラー応答（例: 認証エラー、レートリミット超過）の表示。入力検証: 無効な入力（例: 空のプロンプト）に対する警告。3. 非機能要件3.1 パフォーマンスUI応答性: UI操作はスムーズで、フリーズしないこと。API応答速度: Gemini APIからの応答は、ネットワーク状況に依存するものの、UI上での表示は迅速に行われること。リソース消費: Chrome拡張機能として、メモリやCPUの使用量が過度に高くならないこと。3.2 セキュリティAPIキーの保護: APIキーはクライアントサイドのストレージに保存されるため、chrome.storage.localを使用し、可能な限り安全に扱うこと。コードにハードコードしないこと。データ保護: ユーザーが入力したテキストや画像は、API送信時以外に外部に送信されないこと。3.3 ユーザビリティ直感的な操作: 初めてのユーザーでも迷わず操作できるUI設計。アクセシビリティ: 主要なUI要素はキーボード操作に対応していること（任意）。3.4 互換性ブラウザ: Google Chromeの最新安定版で動作すること。3.5 保守性コード品質: クリーンで読みやすいコード、適切なコメント、モジュール化されたコンポーネント構造。ドキュメンテーション: 技術ドキュメントは最新の状態に保たれること。4. 技術スタックフロントエンドフレームワーク: React (最新版)スタイリング: Tailwind CSSAPIクライアント: fetch APIAIモデル: Google Gemini API (gemini-2.0-flashモデル)Chrome拡張機能API: chrome.storage, chrome.runtimeなど言語: JavaScript (またはTypeScript)シンタックスハイライター: highlight.js または Prism.js (検討)アイコンライブラリ: lucide-react (検討)5. UI/UXデザイン (詳細)5.1 レイアウトメインコンテナ: flexまたはgridを使用して、サイドバー、エディター、出力パネルを配置。サイドバー: 幅固定（例: w-1/5 または w-64px）、背景色 #252526。ナビゲーションアイコンと設定アイコン。エディターエリア: flex-growで残りの幅を占有。上部にテキスト入力エリア、その下に画像プレビューエリア。出力パネル: absoluteまたはgridの行として配置。高さ可変（リサイズ可能にするか、固定高さにするか検討）。ステータスバー: 下部に固定、背景色 #007acc（VS Codeの青色）。5.2 カラースキーム背景色: #1e1e1e (エディター背景), #252526 (サイドバー、パネル背景)文字色: #cccccc (主要テキスト), #808080 (補助テキスト)アクセントカラー: #007acc (アクティブ要素、ステータスバー)ボーダー: #3333335.3 コンポーネント構成 (React)App.js: メインコンポーネント、全体のレイアウトと状態管理。Sidebar.js: サイドバーのナビゲーションと設定リンク。Editor.js: テキスト入力、画像アップロード、送信ボタン。ImagePreview.js: アップロードされた画像の表示。OutputPanel.js: Gemini APIからの応答表示、シンタックスハイライト。Settings.js: APIキー設定フォーム。StatusBar.js: ステータス、エラーメッセージ表示。6. 開発プロセスバージョン管理: Gitを使用し、GitHubリポジトリで管理。ブランチ戦略: mainブランチは常に安定版とし、機能開発はフィーチャーブランチで行う。テスト: 主要な機能（API連携、UI操作）について手動テストを実施。デプロイ: 開発完了後、Chrome拡張機能としてパッケージングし、テスト用としてロード可能にする。7. 今後の拡張性 (将来的な機能)会話履歴の保存と読み込み: chrome.storage.localを使用した会話履歴の永続化。複数のAIモデルの選択: Geminiの異なるモデル（例: gemini-1.5-flashなど）を選択できる機能。プロンプトテンプレート: よく使うプロンプトを保存・呼び出しできる機能。より高度なVS Code機能の模倣:ファイルツリービュー（ダミーでも可）。コマンドパレット風のインタラクション。音声入力: マイクからの音声入力に対応（Web Speech APIなど）。Webページコンテンツの取得: content_scriptsを使用して、現在表示しているWebページのテキストや画像をGeminiに渡す機能。8. 承認この仕様書に記載された内容に両当事者が合意し、承認します。クライアント署名: ______________________氏名: [クライアント担当者氏名]日付: ______________________サービス提供者署名: ______________________氏名: Gemini日付: ______________________
